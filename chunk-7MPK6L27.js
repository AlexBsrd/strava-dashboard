import{a as B}from"./chunk-Y356FJ7L.js";import{b as L}from"./chunk-ZDDGAMWZ.js";import{$ as r,Ia as M,Ja as A,Ka as w,O as i,P as y,Qa as E,Sa as T,V as g,X as d,_ as a,a as u,aa as O,b as C,ba as _,ca as x,fa as l,fb as D,g as h,gb as k,ib as F,ka as c,la as s,ma as m,ob as $,q as S,ta as P,xa as p,ya as v,z as b,za as I}from"./chunk-KXPHHAN7.js";function U(n,e){n&1&&O(0,"app-spinner")}function j(n,e){if(n&1&&(a(0,"div",3),c(1),r()),n&2){let t=l();i(),m(" ",t.error," ")}}function R(n,e){if(n&1&&(_(0),a(1,"div",18)(2,"span",19),c(3),p(4,"translate"),r(),a(5,"span",20),c(6),r()(),a(7,"div",18)(8,"span",19),c(9),p(10,"translate"),r(),a(11,"span",20),c(12),r()(),a(13,"div",18)(14,"span",19),c(15),p(16,"translate"),r(),a(17,"span",20),c(18),r()(),a(19,"div",18)(20,"span",19),c(21),p(22,"translate"),r(),a(23,"span",20),c(24),r()(),x()),n&2){let t=l().$implicit,o=l(3);i(3),s(v(4,8,"activities.table.distance")),i(3),m("",t.distance.toFixed(1)," km"),i(3),s(v(10,10,"activities.table.duration")),i(3),s(o.formatDuration(t.elapsed_time)),i(3),s(v(16,12,"activities.table.avg_speed")),i(3),m("",t.average_speed.toFixed(1)," km/h"),i(3),s(v(22,14,"activities.table.elevation")),i(3),m("",t.total_elevation_gain,"m")}}function H(n,e){if(n&1&&(_(0),a(1,"div",21)(2,"span",19),c(3),p(4,"translate"),r(),a(5,"span",20),c(6),r()(),x()),n&2){let t=l().$implicit,o=l(3);i(3),s(v(4,2,"activities.table.session_duration")),i(3),s(o.formatDuration(t.elapsed_time))}}function V(n,e){if(n&1&&(a(0,"div",12)(1,"div",13)(2,"div",14),c(3),r(),a(4,"div",15),c(5),r()(),a(6,"h3",16),c(7),r(),a(8,"div",17),g(9,R,25,16,"ng-container",1)(10,H,7,4,"ng-container",1),r()()),n&2){let t=e.$implicit,o=l(3);d("ngClass",t.type.toLowerCase()),i(3),m(" ",t.type," "),i(2),m(" ",o.formatTime(t.start_date)," "),i(2),s(t.name),i(2),d("ngIf",o.isCardioActivity(t.type)),i(),d("ngIf",!o.isCardioActivity(t.type))}}function W(n,e){if(n&1&&(a(0,"div",7)(1,"div",8)(2,"div",9),c(3),r()(),a(4,"div",10),g(5,V,11,6,"div",11),r()()),n&2){let t=e.$implicit,o=l(2);i(3),m(" ",o.formatDayHeader(t.key)," "),i(2),d("ngForOf",t.value)}}function Y(n,e){if(n&1&&(a(0,"div")(1,"header",4)(2,"h1"),c(3),p(4,"translate"),r()(),a(5,"div",5),g(6,W,6,2,"div",6),p(7,"keyvalue"),r()()),n&2){let t=l();i(3),s(v(4,2,"activities.title")),i(3),d("ngForOf",I(7,4,t.groupedActivities,t.reverseOrder))}}var N=class n{constructor(e,t,o){this.stravaService=e;this.periodStateService=t;this.translateService=o}activities=[];groupedActivities={};isLoading=!1;error=null;selectedPeriod="week";cardioActivities=["RUN","RIDE","WALK","HIKE","ALPINESKI","BACKCOUNTRYSKI"];destroy$=new h;ngOnInit(){this.periodStateService.dashboardPeriod$.pipe(S(this.destroy$)).subscribe(e=>{this.selectedPeriod=e,this.loadActivities()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}isCardioActivity(e){return this.cardioActivities.includes(e.toUpperCase())}formatDuration(e){let t=Math.floor(e/3600),o=Math.floor(e%3600/60);return t>0?`${t}h ${o}min`:`${o}min`}formatDayHeader(e){let t=this.translateService.currentLang==="en"?"en-US":"fr-FR";return new Date(e).toLocaleDateString(t,{weekday:"long",day:"numeric",month:"long"})}formatTime(e){let t=this.translateService.currentLang==="en"?"en-US":"fr-FR";return new Date(e).toLocaleTimeString(t,{hour:"2-digit",minute:"2-digit"})}reverseOrder=(e,t)=>e.key>t.key?-1:1;loadActivities(){this.isLoading=!0,this.error=null,this.stravaService.getActivities(this.selectedPeriod).subscribe({next:e=>{this.activities=e,this.groupActivitiesByDay(),this.isLoading=!1},error:e=>{console.error("Error loading activities:",e),this.isLoading=!1,this.error=this.translateService.instant("errors.loading_error.title")}})}groupActivitiesByDay(){this.groupedActivities=this.activities.reduce((e,t)=>{let f=new Date(t.start_date).toISOString().split("T")[0];return e[f]||(e[f]=[]),e[f].push(C(u({},t),{start_date:new Date(t.start_date)})),e[f].sort((z,K)=>new Date(K.start_date).getTime()-new Date(z.start_date).getTime()),e},{})}static \u0275fac=function(t){return new(t||n)(y($),y(L),y(D))};static \u0275cmp=b({type:n,selectors:[["app-activities"]],standalone:!0,features:[P],decls:4,vars:3,consts:[[1,"activities-container"],[4,"ngIf"],["class","error-message",4,"ngIf"],[1,"error-message"],[1,"activities-header"],[1,"timeline"],["class","day-group",4,"ngFor","ngForOf"],[1,"day-group"],[1,"day-header"],[1,"date-badge"],[1,"activities-group"],["class","activity-card",3,"ngClass",4,"ngFor","ngForOf"],[1,"activity-card",3,"ngClass"],[1,"activity-header"],[1,"activity-type"],[1,"activity-time"],[1,"activity-name"],[1,"activity-stats"],[1,"stat"],[1,"stat-label"],[1,"stat-value"],[1,"stat","full-width"]],template:function(t,o){t&1&&(a(0,"div",0),g(1,U,1,0,"app-spinner",1)(2,j,2,1,"div",2)(3,Y,8,7,"div",1),r()),t&2&&(i(),d("ngIf",o.isLoading),i(),d("ngIf",o.error),i(),d("ngIf",!o.isLoading&&!o.error))},dependencies:[T,M,A,w,E,F,k,B],styles:[".activities-container[_ngcontent-%COMP%]{padding:2rem;max-width:95%;margin:0 auto}.activities-header[_ngcontent-%COMP%]{margin-bottom:2rem}.activities-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;color:var(--text-primary);margin-bottom:1rem}.timeline[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.day-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.day-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.date-badge[_ngcontent-%COMP%]{background:var(--bg-primary);padding:.5rem 1rem;border-radius:20px;font-weight:500;color:var(--text-primary);font-size:.9rem;box-shadow:var(--shadow-sm)}.activities-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-left:1rem}.activity-card[_ngcontent-%COMP%]{background:var(--bg-primary);border-radius:12px;padding:1.5rem;box-shadow:var(--shadow-sm);border-left:4px solid var(--gray-300);transition:transform .2s,box-shadow .2s}.activity-card[_ngcontent-%COMP%]:hover{transform:translate(4px);box-shadow:var(--shadow-md)}.activity-card.run[_ngcontent-%COMP%]{border-left-color:#ff5722}.activity-card.ride[_ngcontent-%COMP%]{border-left-color:#4caf50}.activity-card.walk[_ngcontent-%COMP%], .activity-card.hike[_ngcontent-%COMP%]{border-left-color:#ff9800}.activity-card.weighttraining[_ngcontent-%COMP%]{border-left-color:#9c27b0}.activity-card.alpineski[_ngcontent-%COMP%]{border-left-color:#2196f3}.activity-card.backcountryski[_ngcontent-%COMP%]{border-left-color:#1976d2}.activity-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem;color:var(--text-secondary)}.activity-type[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500;text-transform:uppercase;color:#666}.activity-time[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.activity-name[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--text-primary);margin-bottom:1rem}.activity-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.stat.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.stat-label[_ngcontent-%COMP%]{font-size:.75rem;color:#666;text-transform:uppercase}.stat-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:#2d3748}.error-message[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--danger-color);background-color:#ffebee;border-radius:var(--radius-md);margin:2rem 0}@media (max-width: 768px){.activities-container[_ngcontent-%COMP%]{padding:1rem}.activity-stats[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{N as ActivitiesComponent};
