import{a,b as s,h as d,l as f,u as h}from"./chunk-KXPHHAN7.js";var T={totalElapsedTime:{labelKey:"metrics.labels.totalElapsedTime",unit:"",isTime:!0},averageSpeed:{labelKey:"metrics.labels.averageSpeed",unit:"km/h"},totalDistance:{labelKey:"metrics.labels.totalDistance",unit:"km"},averageDistance:{labelKey:"metrics.labels.averageDistance",unit:"km"},totalElevation:{labelKey:"metrics.labels.totalElevation",unit:"m"},averageElevation:{labelKey:"metrics.labels.averageElevation",unit:"m"}},c=["totalElapsedTime","averageSpeed","totalDistance","averageDistance","totalElevation","averageElevation"],E={Run:{type:"Run",labelKey:"sports.types.Run",icon:"run",category:"running",hasDistance:!0,hasElevation:!0},VirtualRun:{type:"VirtualRun",labelKey:"sports.types.VirtualRun",icon:"run",category:"running",hasDistance:!0,hasElevation:!1},TrailRun:{type:"TrailRun",labelKey:"sports.types.TrailRun",icon:"trail",category:"running",hasDistance:!0,hasElevation:!0},Ride:{type:"Ride",labelKey:"sports.types.Ride",icon:"bike",category:"cycling",hasDistance:!0,hasElevation:!0},MountainBikeRide:{type:"MountainBikeRide",labelKey:"sports.types.MountainBikeRide",icon:"mtb",category:"cycling",hasDistance:!0,hasElevation:!0},GravelRide:{type:"GravelRide",labelKey:"sports.types.GravelRide",icon:"bike",category:"cycling",hasDistance:!0,hasElevation:!0},VirtualRide:{type:"VirtualRide",labelKey:"sports.types.VirtualRide",icon:"bike",category:"cycling",hasDistance:!0,hasElevation:!1},EBikeRide:{type:"EBikeRide",labelKey:"sports.types.EBikeRide",icon:"ebike",category:"cycling",hasDistance:!0,hasElevation:!0},Walk:{type:"Walk",labelKey:"sports.types.Walk",icon:"walk",category:"walking",hasDistance:!0,hasElevation:!0},Hike:{type:"Hike",labelKey:"sports.types.Hike",icon:"hike",category:"walking",hasDistance:!0,hasElevation:!0},WeightTraining:{type:"WeightTraining",labelKey:"sports.types.WeightTraining",icon:"weight",category:"fitness",hasDistance:!1,hasElevation:!1},Yoga:{type:"Yoga",labelKey:"sports.types.Yoga",icon:"yoga",category:"fitness",hasDistance:!1,hasElevation:!1},Workout:{type:"Workout",labelKey:"sports.types.Workout",icon:"workout",category:"fitness",hasDistance:!1,hasElevation:!1},CrossFit:{type:"CrossFit",labelKey:"sports.types.CrossFit",icon:"crossfit",category:"fitness",hasDistance:!1,hasElevation:!1},Elliptical:{type:"Elliptical",labelKey:"sports.types.Elliptical",icon:"elliptical",category:"fitness",hasDistance:!1,hasElevation:!1},StairStepper:{type:"StairStepper",labelKey:"sports.types.StairStepper",icon:"stairs",category:"fitness",hasDistance:!1,hasElevation:!1},Swim:{type:"Swim",labelKey:"sports.types.Swim",icon:"swim",category:"water",hasDistance:!0,hasElevation:!1},Rowing:{type:"Rowing",labelKey:"sports.types.Rowing",icon:"rowing",category:"water",hasDistance:!0,hasElevation:!1},Kayaking:{type:"Kayaking",labelKey:"sports.types.Kayaking",icon:"kayak",category:"water",hasDistance:!0,hasElevation:!1},Canoeing:{type:"Canoeing",labelKey:"sports.types.Canoeing",icon:"canoe",category:"water",hasDistance:!0,hasElevation:!1},StandUpPaddling:{type:"StandUpPaddling",labelKey:"sports.types.StandUpPaddling",icon:"paddle",category:"water",hasDistance:!0,hasElevation:!1},Surfing:{type:"Surfing",labelKey:"sports.types.Surfing",icon:"surf",category:"water",hasDistance:!1,hasElevation:!1},AlpineSki:{type:"AlpineSki",labelKey:"sports.types.AlpineSki",icon:"ski",category:"winter",hasDistance:!0,hasElevation:!0},BackcountrySki:{type:"BackcountrySki",labelKey:"sports.types.BackcountrySki",icon:"ski",category:"winter",hasDistance:!0,hasElevation:!0},NordicSki:{type:"NordicSki",labelKey:"sports.types.NordicSki",icon:"nordic",category:"winter",hasDistance:!0,hasElevation:!0},Snowboard:{type:"Snowboard",labelKey:"sports.types.Snowboard",icon:"snowboard",category:"winter",hasDistance:!0,hasElevation:!0},IceSkate:{type:"IceSkate",labelKey:"sports.types.IceSkate",icon:"skate",category:"winter",hasDistance:!0,hasElevation:!1},Skateboard:{type:"Skateboard",labelKey:"sports.types.Skateboard",icon:"skateboard",category:"other",hasDistance:!0,hasElevation:!1},InlineSkate:{type:"InlineSkate",labelKey:"sports.types.InlineSkate",icon:"roller",category:"other",hasDistance:!0,hasElevation:!1},RockClimbing:{type:"RockClimbing",labelKey:"sports.types.RockClimbing",icon:"climbing",category:"other",hasDistance:!1,hasElevation:!0},Golf:{type:"Golf",labelKey:"sports.types.Golf",icon:"golf",category:"other",hasDistance:!0,hasElevation:!1},Tennis:{type:"Tennis",labelKey:"sports.types.Tennis",icon:"tennis",category:"other",hasDistance:!1,hasElevation:!1},Soccer:{type:"Soccer",labelKey:"sports.types.Soccer",icon:"soccer",category:"other",hasDistance:!0,hasElevation:!1}},v=[{id:"running",nameKey:"sports.groups.running",types:["Run","VirtualRun","TrailRun"],icon:"run",color:"#ef4444",isDefault:!0,isEnabled:!0,order:0,visibleMetrics:[...c]},{id:"walking",nameKey:"sports.groups.walking",types:["Walk","Hike"],icon:"walk",color:"#22c55e",isDefault:!0,isEnabled:!0,order:1,visibleMetrics:[...c]},{id:"cycling",nameKey:"sports.groups.cycling",types:["Ride","MountainBikeRide","GravelRide","VirtualRide","EBikeRide"],icon:"bike",color:"#3b82f6",isDefault:!0,isEnabled:!0,order:2,visibleMetrics:[...c]}],g={version:3,groups:v,showUngroupedSports:!1,ungroupedSportsEnabled:[],ungroupedSportsConfig:{}},k=["#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899"];function u(l){return E[l]||{type:l,labelKey:l,icon:"activity",category:"other",hasDistance:!1,hasElevation:!1}}function y(l){let e=["totalElapsedTime"];return l.some(r=>u(r).hasDistance)&&e.push("averageSpeed","totalDistance","averageDistance"),l.some(r=>u(r).hasElevation)&&e.push("totalElevation","averageElevation"),e}function S(){return`custom-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}var b=class l{STORAGE_KEY="sport_config";config=new d(g);availableTypes=new d([]);config$=this.config.asObservable();availableTypes$=this.availableTypes.asObservable();enabledGroups$=this.config$.pipe(f(e=>e.groups.filter(t=>t.isEnabled).sort((t,i)=>t.order-i.order)));allGroups$=this.config$.pipe(f(e=>[...e.groups].sort((t,i)=>t.order-i.order)));constructor(){this.loadConfig()}loadConfig(){try{let e=localStorage.getItem(this.STORAGE_KEY);if(e){let t=JSON.parse(e),i=this.migrateConfig(t);this.config.next(i)}}catch(e){console.warn("Erreur lors du chargement de la configuration des sports:",e),this.config.next(a({},g))}}saveConfig(){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.config.value))}catch(e){console.error("Erreur lors de la sauvegarde de la configuration des sports:",e)}}migrateConfig(e){let t=a({},e);if(t.version<2&&(t=s(a({},t),{version:2,groups:t.groups.map(i=>s(a({},i),{visibleMetrics:i.visibleMetrics||[...c]}))})),t.version<3){let i={};(t.ungroupedSportsEnabled||[]).forEach(o=>{i[o]={type:o,isEnabled:!0,visibleMetrics:y([o])}}),t=s(a({},t),{version:3,ungroupedSportsConfig:i})}return t}getConfig(){return this.config.value}getEnabledGroups(){return this.config.value.groups.filter(e=>e.isEnabled).sort((e,t)=>e.order-t.order)}getAllGroups(){return[...this.config.value.groups].sort((e,t)=>e.order-t.order)}getGroupById(e){return this.config.value.groups.find(t=>t.id===e)}toggleGroup(e){let t=this.config.value,i=t.groups.findIndex(r=>r.id===e);if(i!==-1){let r=[...t.groups];r[i]=s(a({},r[i]),{isEnabled:!r[i].isEnabled}),this.config.next(s(a({},t),{groups:r})),this.saveConfig()}}reorderGroups(e){let t=this.config.value,i=t.groups.map(r=>{let o=e.indexOf(r.id);return s(a({},r),{order:o!==-1?o:r.order})});this.config.next(s(a({},t),{groups:i})),this.saveConfig()}moveGroup(e,t){let i=this.getAllGroups(),r=i.findIndex(p=>p.id===e);if(r===-1)return;let o=t==="up"?r-1:r+1;if(o<0||o>=i.length)return;let n=i.map(p=>p.id);[n[r],n[o]]=[n[o],n[r]],this.reorderGroups(n)}createGroup(e,t,i,r,o){let n=this.config.value,p={id:S(),nameKey:e,types:t,icon:i,color:r,isDefault:!1,isEnabled:!0,order:n.groups.length,visibleMetrics:o||[...c]};return this.config.next(s(a({},n),{groups:[...n.groups,p]})),this.saveConfig(),p}updateGroup(e,t){let i=this.config.value,r=i.groups.findIndex(n=>n.id===e);if(r===-1)return!1;let o=[...i.groups];return o[r]=a(a({},o[r]),t),this.config.next(s(a({},i),{groups:o})),this.saveConfig(),!0}deleteGroup(e){let t=this.config.value,i=t.groups.find(o=>o.id===e);if(!i||i.isDefault)return!1;let r=t.groups.filter(o=>o.id!==e);return r.forEach((o,n)=>{o.order=n}),this.config.next(s(a({},t),{groups:r})),this.saveConfig(),!0}resetToDefaults(){this.config.next(s(a({},g),{groups:[...v]})),this.saveConfig()}detectAvailableTypes(e){let t=new Set;e.forEach(r=>t.add(r.sport_type||r.type));let i=Array.from(t).sort();return this.availableTypes.next(i),i}getAvailableTypes(){return this.availableTypes.value}filterActivitiesByGroup(e,t){return e.filter(i=>{let r=i.sport_type||i.type;return!!(t.types.includes(r)||!i.sport_type&&t.types.includes(i.type))})}filterActivitiesByEnabledGroups(e){return this.getEnabledGroups().map(i=>({group:i,activities:this.filterActivitiesByGroup(e,i)}))}getUngroupedTypes(e){let t=this.detectAvailableTypes(e),i=new Set;return this.config.value.groups.forEach(r=>{r.types.forEach(o=>{i.add(o)})}),t.filter(r=>!i.has(r))}toggleUngroupedSport(e){let t=this.config.value,i=[...t.ungroupedSportsEnabled],r=a({},t.ungroupedSportsConfig),o=i.indexOf(e);o===-1?(i.push(e),r[e]?r[e]=s(a({},r[e]),{isEnabled:!0}):r[e]={type:e,isEnabled:!0,visibleMetrics:y([e])}):(i.splice(o,1),r[e]&&(r[e]=s(a({},r[e]),{isEnabled:!1}))),this.config.next(s(a({},t),{ungroupedSportsEnabled:i,ungroupedSportsConfig:r})),this.saveConfig()}isUngroupedSportEnabled(e){return this.config.value.ungroupedSportsEnabled.includes(e)}getUngroupedSportConfig(e){return this.config.value.ungroupedSportsConfig[e]}updateUngroupedSportMetrics(e,t){let i=this.config.value,r=a({},i.ungroupedSportsConfig);r[e]?r[e]=s(a({},r[e]),{visibleMetrics:t}):r[e]={type:e,isEnabled:this.isUngroupedSportEnabled(e),visibleMetrics:t},this.config.next(s(a({},i),{ungroupedSportsConfig:r})),this.saveConfig()}toggleUngroupedSportMetric(e,t){let r=this.getUngroupedSportConfig(e)?.visibleMetrics||y([e]),o;r.includes(t)?o=r.filter(n=>n!==t):o=[...r,t],this.updateUngroupedSportMetrics(e,o)}toggleShowUngroupedSports(){let e=this.config.value;this.config.next(s(a({},e),{showUngroupedSports:!e.showUngroupedSports})),this.saveConfig()}getSportMetadata(e){return u(e)}isTypeCoveredByGroups(e){return this.config.value.groups.some(t=>t.types.some(i=>e===i||e.includes(i)))}isTypeInAnyGroup(e){return this.config.value.groups.some(t=>t.types.includes(e))}getGroupContainingType(e){return this.config.value.groups.find(t=>t.types.includes(e))||null}static \u0275fac=function(t){return new(t||l)};static \u0275prov=h({token:l,factory:l.\u0275fac,providedIn:"root"})};export{T as a,c as b,k as c,u as d,y as e,b as f};
