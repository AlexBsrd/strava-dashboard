import{a as r,b as n,h as f,l as v,u as h}from"./chunk-WWAAJI6Y.js";var T={totalElapsedTime:{label:"Temps total",unit:"",isTime:!0},averageSpeed:{label:"Vitesse moyenne",unit:"km/h"},totalDistance:{label:"Distance totale",unit:"km"},averageDistance:{label:"Distance moyenne/sortie",unit:"km"},totalElevation:{label:"D\xE9nivel\xE9 total",unit:"m"},averageElevation:{label:"D\xE9nivel\xE9 moyen/sortie",unit:"m"}},p=["totalElapsedTime","averageSpeed","totalDistance","averageDistance","totalElevation","averageElevation"],E={Run:{type:"Run",label:"Course",icon:"run",category:"running",hasDistance:!0,hasElevation:!0},VirtualRun:{type:"VirtualRun",label:"Course virtuelle",icon:"run",category:"running",hasDistance:!0,hasElevation:!1},TrailRun:{type:"TrailRun",label:"Trail",icon:"trail",category:"running",hasDistance:!0,hasElevation:!0},Ride:{type:"Ride",label:"V\xE9lo",icon:"bike",category:"cycling",hasDistance:!0,hasElevation:!0},MountainBikeRide:{type:"MountainBikeRide",label:"VTT",icon:"mtb",category:"cycling",hasDistance:!0,hasElevation:!0},GravelRide:{type:"GravelRide",label:"Gravel",icon:"bike",category:"cycling",hasDistance:!0,hasElevation:!0},VirtualRide:{type:"VirtualRide",label:"V\xE9lo virtuel",icon:"bike",category:"cycling",hasDistance:!0,hasElevation:!1},EBikeRide:{type:"EBikeRide",label:"V\xE9lo \xE9lectrique",icon:"ebike",category:"cycling",hasDistance:!0,hasElevation:!0},Walk:{type:"Walk",label:"Marche",icon:"walk",category:"walking",hasDistance:!0,hasElevation:!0},Hike:{type:"Hike",label:"Randonn\xE9e",icon:"hike",category:"walking",hasDistance:!0,hasElevation:!0},WeightTraining:{type:"WeightTraining",label:"Musculation",icon:"weight",category:"fitness",hasDistance:!1,hasElevation:!1},Yoga:{type:"Yoga",label:"Yoga",icon:"yoga",category:"fitness",hasDistance:!1,hasElevation:!1},Workout:{type:"Workout",label:"Entra\xEEnement",icon:"workout",category:"fitness",hasDistance:!1,hasElevation:!1},CrossFit:{type:"CrossFit",label:"CrossFit",icon:"crossfit",category:"fitness",hasDistance:!1,hasElevation:!1},Elliptical:{type:"Elliptical",label:"Elliptique",icon:"elliptical",category:"fitness",hasDistance:!1,hasElevation:!1},StairStepper:{type:"StairStepper",label:"Stepper",icon:"stairs",category:"fitness",hasDistance:!1,hasElevation:!1},Swim:{type:"Swim",label:"Natation",icon:"swim",category:"water",hasDistance:!0,hasElevation:!1},Rowing:{type:"Rowing",label:"Aviron",icon:"rowing",category:"water",hasDistance:!0,hasElevation:!1},Kayaking:{type:"Kayaking",label:"Kayak",icon:"kayak",category:"water",hasDistance:!0,hasElevation:!1},Canoeing:{type:"Canoeing",label:"Cano\xEB",icon:"canoe",category:"water",hasDistance:!0,hasElevation:!1},StandUpPaddling:{type:"StandUpPaddling",label:"Paddle",icon:"paddle",category:"water",hasDistance:!0,hasElevation:!1},Surfing:{type:"Surfing",label:"Surf",icon:"surf",category:"water",hasDistance:!1,hasElevation:!1},AlpineSki:{type:"AlpineSki",label:"Ski alpin",icon:"ski",category:"winter",hasDistance:!0,hasElevation:!0},BackcountrySki:{type:"BackcountrySki",label:"Ski de randonn\xE9e",icon:"ski",category:"winter",hasDistance:!0,hasElevation:!0},NordicSki:{type:"NordicSki",label:"Ski de fond",icon:"nordic",category:"winter",hasDistance:!0,hasElevation:!0},Snowboard:{type:"Snowboard",label:"Snowboard",icon:"snowboard",category:"winter",hasDistance:!0,hasElevation:!0},IceSkate:{type:"IceSkate",label:"Patinage",icon:"skate",category:"winter",hasDistance:!0,hasElevation:!1},Skateboard:{type:"Skateboard",label:"Skateboard",icon:"skateboard",category:"other",hasDistance:!0,hasElevation:!1},InlineSkate:{type:"InlineSkate",label:"Roller",icon:"roller",category:"other",hasDistance:!0,hasElevation:!1},RockClimbing:{type:"RockClimbing",label:"Escalade",icon:"climbing",category:"other",hasDistance:!1,hasElevation:!0},Golf:{type:"Golf",label:"Golf",icon:"golf",category:"other",hasDistance:!0,hasElevation:!1},Tennis:{type:"Tennis",label:"Tennis",icon:"tennis",category:"other",hasDistance:!1,hasElevation:!1},Soccer:{type:"Soccer",label:"Football",icon:"soccer",category:"other",hasDistance:!0,hasElevation:!1}},y=[{id:"running",name:"Course",types:["Run","VirtualRun","TrailRun"],icon:"run",color:"#ef4444",isDefault:!0,isEnabled:!0,order:0,visibleMetrics:[...p]},{id:"walking",name:"Marche",types:["Walk","Hike"],icon:"walk",color:"#22c55e",isDefault:!0,isEnabled:!0,order:1,visibleMetrics:[...p]},{id:"cycling",name:"V\xE9lo",types:["Ride","MountainBikeRide","GravelRide","VirtualRide","EBikeRide"],icon:"bike",color:"#3b82f6",isDefault:!0,isEnabled:!0,order:2,visibleMetrics:[...p]}],g={version:3,groups:y,showUngroupedSports:!1,ungroupedSportsEnabled:[],ungroupedSportsConfig:{}},k=["#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899"];function u(l){return E[l]||{type:l,label:l,icon:"activity",category:"other",hasDistance:!1,hasElevation:!1}}function d(l){let e=["totalElapsedTime"];return l.some(a=>u(a).hasDistance)&&e.push("averageSpeed","totalDistance","averageDistance"),l.some(a=>u(a).hasElevation)&&e.push("totalElevation","averageElevation"),e}function S(){return`custom-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}var b=class l{STORAGE_KEY="sport_config";config=new f(g);availableTypes=new f([]);config$=this.config.asObservable();availableTypes$=this.availableTypes.asObservable();enabledGroups$=this.config$.pipe(v(e=>e.groups.filter(t=>t.isEnabled).sort((t,i)=>t.order-i.order)));allGroups$=this.config$.pipe(v(e=>[...e.groups].sort((t,i)=>t.order-i.order)));constructor(){this.loadConfig()}loadConfig(){try{let e=localStorage.getItem(this.STORAGE_KEY);if(e){let t=JSON.parse(e),i=this.migrateConfig(t);this.config.next(i)}}catch(e){console.warn("Erreur lors du chargement de la configuration des sports:",e),this.config.next(r({},g))}}saveConfig(){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.config.value))}catch(e){console.error("Erreur lors de la sauvegarde de la configuration des sports:",e)}}migrateConfig(e){let t=r({},e);if(t.version<2&&(t=n(r({},t),{version:2,groups:t.groups.map(i=>n(r({},i),{visibleMetrics:i.visibleMetrics||[...p]}))})),t.version<3){let i={};(t.ungroupedSportsEnabled||[]).forEach(o=>{i[o]={type:o,isEnabled:!0,visibleMetrics:d([o])}}),t=n(r({},t),{version:3,ungroupedSportsConfig:i})}return t}getConfig(){return this.config.value}getEnabledGroups(){return this.config.value.groups.filter(e=>e.isEnabled).sort((e,t)=>e.order-t.order)}getAllGroups(){return[...this.config.value.groups].sort((e,t)=>e.order-t.order)}getGroupById(e){return this.config.value.groups.find(t=>t.id===e)}toggleGroup(e){let t=this.config.value,i=t.groups.findIndex(a=>a.id===e);if(i!==-1){let a=[...t.groups];a[i]=n(r({},a[i]),{isEnabled:!a[i].isEnabled}),this.config.next(n(r({},t),{groups:a})),this.saveConfig()}}reorderGroups(e){let t=this.config.value,i=t.groups.map(a=>{let o=e.indexOf(a.id);return n(r({},a),{order:o!==-1?o:a.order})});this.config.next(n(r({},t),{groups:i})),this.saveConfig()}moveGroup(e,t){let i=this.getAllGroups(),a=i.findIndex(c=>c.id===e);if(a===-1)return;let o=t==="up"?a-1:a+1;if(o<0||o>=i.length)return;let s=i.map(c=>c.id);[s[a],s[o]]=[s[o],s[a]],this.reorderGroups(s)}createGroup(e,t,i,a,o){let s=this.config.value,c={id:S(),name:e,types:t,icon:i,color:a,isDefault:!1,isEnabled:!0,order:s.groups.length,visibleMetrics:o||[...p]};return this.config.next(n(r({},s),{groups:[...s.groups,c]})),this.saveConfig(),c}updateGroup(e,t){let i=this.config.value,a=i.groups.findIndex(s=>s.id===e);if(a===-1)return!1;let o=[...i.groups];return o[a]=r(r({},o[a]),t),this.config.next(n(r({},i),{groups:o})),this.saveConfig(),!0}deleteGroup(e){let t=this.config.value,i=t.groups.find(o=>o.id===e);if(!i||i.isDefault)return!1;let a=t.groups.filter(o=>o.id!==e);return a.forEach((o,s)=>{o.order=s}),this.config.next(n(r({},t),{groups:a})),this.saveConfig(),!0}resetToDefaults(){this.config.next(n(r({},g),{groups:[...y]})),this.saveConfig()}detectAvailableTypes(e){let t=new Set;e.forEach(a=>t.add(a.sport_type||a.type));let i=Array.from(t).sort();return this.availableTypes.next(i),i}getAvailableTypes(){return this.availableTypes.value}filterActivitiesByGroup(e,t){return e.filter(i=>{let a=i.sport_type||i.type;return!!(t.types.includes(a)||!i.sport_type&&t.types.includes(i.type))})}filterActivitiesByEnabledGroups(e){return this.getEnabledGroups().map(i=>({group:i,activities:this.filterActivitiesByGroup(e,i)}))}getUngroupedTypes(e){let t=this.detectAvailableTypes(e),i=new Set;return this.config.value.groups.forEach(a=>{a.types.forEach(o=>{i.add(o)})}),t.filter(a=>!i.has(a))}toggleUngroupedSport(e){let t=this.config.value,i=[...t.ungroupedSportsEnabled],a=r({},t.ungroupedSportsConfig),o=i.indexOf(e);o===-1?(i.push(e),a[e]?a[e]=n(r({},a[e]),{isEnabled:!0}):a[e]={type:e,isEnabled:!0,visibleMetrics:d([e])}):(i.splice(o,1),a[e]&&(a[e]=n(r({},a[e]),{isEnabled:!1}))),this.config.next(n(r({},t),{ungroupedSportsEnabled:i,ungroupedSportsConfig:a})),this.saveConfig()}isUngroupedSportEnabled(e){return this.config.value.ungroupedSportsEnabled.includes(e)}getUngroupedSportConfig(e){return this.config.value.ungroupedSportsConfig[e]}updateUngroupedSportMetrics(e,t){let i=this.config.value,a=r({},i.ungroupedSportsConfig);a[e]?a[e]=n(r({},a[e]),{visibleMetrics:t}):a[e]={type:e,isEnabled:this.isUngroupedSportEnabled(e),visibleMetrics:t},this.config.next(n(r({},i),{ungroupedSportsConfig:a})),this.saveConfig()}toggleUngroupedSportMetric(e,t){let a=this.getUngroupedSportConfig(e)?.visibleMetrics||d([e]),o;a.includes(t)?o=a.filter(s=>s!==t):o=[...a,t],this.updateUngroupedSportMetrics(e,o)}toggleShowUngroupedSports(){let e=this.config.value;this.config.next(n(r({},e),{showUngroupedSports:!e.showUngroupedSports})),this.saveConfig()}getSportMetadata(e){return u(e)}isTypeCoveredByGroups(e){return this.config.value.groups.some(t=>t.types.some(i=>e===i||e.includes(i)))}isTypeInAnyGroup(e){return this.config.value.groups.some(t=>t.types.includes(e))}getGroupContainingType(e){return this.config.value.groups.find(t=>t.types.includes(e))||null}static \u0275fac=function(t){return new(t||l)};static \u0275prov=h({token:l,factory:l.\u0275fac,providedIn:"root"})};export{T as a,p as b,k as c,u as d,d as e,b as f};
