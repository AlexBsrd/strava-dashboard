import{a as T}from"./chunk-KFEAXAMW.js";import{b as D}from"./chunk-VFSQ6VWS.js";import{$ as S,Ea as M,Fa as E,Ga as A,Ma as I,N as o,O as g,Oa as w,U as l,W as s,Z as n,_ as r,a as _,aa as f,b as u,ba as y,ea as d,eb as k,g as x,ja as c,ka as v,la as m,q as C,ra as O,ta as P,va as b,z as h}from"./chunk-WWAAJI6Y.js";function N(i,e){i&1&&S(0,"app-spinner")}function z(i,e){if(i&1&&(n(0,"div",3),c(1),r()),i&2){let t=d();o(),m(" ",t.error," ")}}function K(i,e){if(i&1&&(f(0),n(1,"div",18)(2,"span",19),c(3,"Distance"),r(),n(4,"span",20),c(5),r()(),n(6,"div",18)(7,"span",19),c(8,"Dur\xE9e"),r(),n(9,"span",20),c(10),r()(),n(11,"div",18)(12,"span",19),c(13,"Vitesse moy."),r(),n(14,"span",20),c(15),r()(),n(16,"div",18)(17,"span",19),c(18,"D\xE9nivel\xE9"),r(),n(19,"span",20),c(20),r()(),y()),i&2){let t=d().$implicit,a=d(3);o(5),m("",t.distance.toFixed(1)," km"),o(5),v(a.formatDuration(t.elapsed_time)),o(5),m("",t.average_speed.toFixed(1)," km/h"),o(5),m("",t.total_elevation_gain,"m")}}function R(i,e){if(i&1&&(f(0),n(1,"div",21)(2,"span",19),c(3,"Dur\xE9e de s\xE9ance"),r(),n(4,"span",20),c(5),r()(),y()),i&2){let t=d().$implicit,a=d(3);o(5),v(a.formatDuration(t.elapsed_time))}}function U(i,e){if(i&1&&(n(0,"div",12)(1,"div",13)(2,"div",14),c(3),r(),n(4,"div",15),c(5),r()(),n(6,"h3",16),c(7),r(),n(8,"div",17),l(9,K,21,4,"ng-container",1)(10,R,6,1,"ng-container",1),r()()),i&2){let t=e.$implicit,a=d(3);s("ngClass",t.type.toLowerCase()),o(3),m(" ",t.type," "),o(2),m(" ",a.formatTime(t.start_date)," "),o(2),v(t.name),o(2),s("ngIf",a.isCardioActivity(t.type)),o(),s("ngIf",!a.isCardioActivity(t.type))}}function j(i,e){if(i&1&&(n(0,"div",7)(1,"div",8)(2,"div",9),c(3),r()(),n(4,"div",10),l(5,U,11,6,"div",11),r()()),i&2){let t=e.$implicit,a=d(2);o(3),m(" ",a.formatDayHeader(t.key)," "),o(2),s("ngForOf",t.value)}}function B(i,e){if(i&1&&(n(0,"div")(1,"header",4)(2,"h1"),c(3,"Mes Activit\xE9s"),r()(),n(4,"div",5),l(5,j,6,2,"div",6),P(6,"keyvalue"),r()()),i&2){let t=d();o(5),s("ngForOf",b(6,1,t.groupedActivities,t.reverseOrder))}}var F=class i{constructor(e,t){this.stravaService=e;this.periodStateService=t}activities=[];groupedActivities={};isLoading=!1;error=null;selectedPeriod="week";cardioActivities=["RUN","RIDE","WALK","HIKE","ALPINESKI","BACKCOUNTRYSKI"];destroy$=new x;ngOnInit(){this.periodStateService.dashboardPeriod$.pipe(C(this.destroy$)).subscribe(e=>{this.selectedPeriod=e,this.loadActivities()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}isCardioActivity(e){return this.cardioActivities.includes(e.toUpperCase())}formatDuration(e){let t=Math.floor(e/3600),a=Math.floor(e%3600/60);return t>0?`${t}h ${a}min`:`${a}min`}formatDayHeader(e){return new Date(e).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})}formatTime(e){return new Date(e).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}reverseOrder=(e,t)=>e.key>t.key?-1:1;loadActivities(){this.isLoading=!0,this.error=null,this.stravaService.getActivities(this.selectedPeriod).subscribe({next:e=>{this.activities=e,this.groupActivitiesByDay(),this.isLoading=!1},error:e=>{console.error("Error loading activities:",e),this.isLoading=!1,this.error="Une erreur est survenue lors du chargement des activit\xE9s."}})}groupActivitiesByDay(){this.groupedActivities=this.activities.reduce((e,t)=>{let p=new Date(t.start_date).toISOString().split("T")[0];return e[p]||(e[p]=[]),e[p].push(u(_({},t),{start_date:new Date(t.start_date)})),e[p].sort(($,L)=>new Date(L.start_date).getTime()-new Date($.start_date).getTime()),e},{})}static \u0275fac=function(t){return new(t||i)(g(k),g(D))};static \u0275cmp=h({type:i,selectors:[["app-activities"]],standalone:!0,features:[O],decls:4,vars:3,consts:[[1,"activities-container"],[4,"ngIf"],["class","error-message",4,"ngIf"],[1,"error-message"],[1,"activities-header"],[1,"timeline"],["class","day-group",4,"ngFor","ngForOf"],[1,"day-group"],[1,"day-header"],[1,"date-badge"],[1,"activities-group"],["class","activity-card",3,"ngClass",4,"ngFor","ngForOf"],[1,"activity-card",3,"ngClass"],[1,"activity-header"],[1,"activity-type"],[1,"activity-time"],[1,"activity-name"],[1,"activity-stats"],[1,"stat"],[1,"stat-label"],[1,"stat-value"],[1,"stat","full-width"]],template:function(t,a){t&1&&(n(0,"div",0),l(1,N,1,0,"app-spinner",1)(2,z,2,1,"div",2)(3,B,7,4,"div",1),r()),t&2&&(o(),s("ngIf",a.isLoading),o(),s("ngIf",a.error),o(),s("ngIf",!a.isLoading&&!a.error))},dependencies:[w,M,E,A,I,T],styles:[".activities-container[_ngcontent-%COMP%]{padding:2rem;max-width:95%;margin:0 auto}.activities-header[_ngcontent-%COMP%]{margin-bottom:2rem}.activities-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;color:var(--text-primary);margin-bottom:1rem}.timeline[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.day-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.day-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.date-badge[_ngcontent-%COMP%]{background:var(--bg-primary);padding:.5rem 1rem;border-radius:20px;font-weight:500;color:var(--text-primary);font-size:.9rem;box-shadow:var(--shadow-sm)}.activities-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-left:1rem}.activity-card[_ngcontent-%COMP%]{background:var(--bg-primary);border-radius:12px;padding:1.5rem;box-shadow:var(--shadow-sm);border-left:4px solid var(--gray-300);transition:transform .2s,box-shadow .2s}.activity-card[_ngcontent-%COMP%]:hover{transform:translate(4px);box-shadow:var(--shadow-md)}.activity-card.run[_ngcontent-%COMP%]{border-left-color:#ff5722}.activity-card.ride[_ngcontent-%COMP%]{border-left-color:#4caf50}.activity-card.walk[_ngcontent-%COMP%], .activity-card.hike[_ngcontent-%COMP%]{border-left-color:#ff9800}.activity-card.weighttraining[_ngcontent-%COMP%]{border-left-color:#9c27b0}.activity-card.alpineski[_ngcontent-%COMP%]{border-left-color:#2196f3}.activity-card.backcountryski[_ngcontent-%COMP%]{border-left-color:#1976d2}.activity-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem;color:var(--text-secondary)}.activity-type[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500;text-transform:uppercase;color:#666}.activity-time[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.activity-name[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--text-primary);margin-bottom:1rem}.activity-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.stat.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.stat-label[_ngcontent-%COMP%]{font-size:.75rem;color:#666;text-transform:uppercase}.stat-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:#2d3748}.error-message[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--danger-color);background-color:#ffebee;border-radius:var(--radius-md);margin:2rem 0}@media (max-width: 768px){.activities-container[_ngcontent-%COMP%]{padding:1rem}.activity-stats[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{F as ActivitiesComponent};
